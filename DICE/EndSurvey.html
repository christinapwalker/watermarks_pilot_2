{{ block title }}Thank You{{ endblock }}

{{ block content }}
    <div class="text-center">
        <h2>Thank You!</h2>
        <p>Thank you for participating in our survey.</p>
        <p><strong>You should be redirected to Prolific automatically in a few seconds...</strong></p>
        <p>If you are not redirected automatically, <a href="#" id="manual-redirect">click here</a>.</p>

        <div id="countdown">
            <p>Redirecting in <span id="timer">5</span> seconds...</p>
        </div>
    </div>

    <script>
        // Get the completion link from js_vars
        const completionLink = "{{ js_vars.completionlink }}";

        // Countdown timer
        let timeLeft = 5;
        const timerElement = document.getElementById('timer');
        const countdownElement = document.getElementById('countdown');

        const countdown = setInterval(() => {
            timeLeft--;
            timerElement.textContent = timeLeft;

            if (timeLeft <= 0) {
                clearInterval(countdown);
                countdownElement.innerHTML = '<p><strong>Redirecting now...</strong></p>';
                window.location.href = completionLink;
            }
        }, 1000);

        // Manual redirect link
        document.getElementById('manual-redirect').addEventListener('click', function(e) {
            e.preventDefault();
            clearInterval(countdown);
            window.location.href = completionLink;
        });

        // Also redirect when the page timeout occurs (backup)
        setTimeout(() => {
            window.location.href = completionLink;
        }, 6000); // Slightly longer than the countdown as backup
    </script>
{{ endblock }}